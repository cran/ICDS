<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Junwei Han" />


<title>ICDS User Guide</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">ICDS User Guide</h1>
<h4 class="author">Junwei Han</h4>



<div id="introduce" class="section level2">
<h2>1 Introduce</h2>
<p>This vignette illustrates how to easily use the ICDS package. This
package can identifying cancer risk subpathways which can explain the
disturbed biological functions in more detail and accurately.</p>
<ul>
<li><p>This package provides the
<code>getExpp</code>,<code>getMethp</code>,<code>getCnvp</code>function
to calculate p-values or corrected p-values for each gene.</p></li>
<li><p>This package provides the
<code>coverp2zscore</code>,<code>combinep_two</code>,<code>combinep_three</code>
function to Convert p-values or corrected p-values to z-scores.</p></li>
<li><p>This package provides the <code>FindSubPath</code> function to
search for interested subpathways in each entire pathway.</p></li>
<li><p>This package provides the <code>opt_subpath</code> function to
Optimize interested subpathways.</p></li>
<li><p>This package provides the <code>Permutation</code> function to to
calculate statistical significance for these interested subpathways
.</p></li>
</ul>
</div>
<div id="example-obtain-p-values-or-corrected-p-values-for-each-gene" class="section level2">
<h2>2 Example: Obtain p-values or corrected p-values for each gene</h2>
<p>We can use function getExampleData to return example data and
environment variables, such as the data of exp_data.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">library</span>(ICDS)</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="co"># obtain the expression profile data</span></span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a>exp_data<span class="ot">&lt;-</span><span class="fu">GetExampleData</span>(<span class="st">&quot;exp_data&quot;</span>)</span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a><span class="co">#view first six rows and six colmns of data</span></span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a>exp_data[<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>]</span></code></pre></div>
<pre><code>##       TCGA.38.4632.11 TCGA.44.5645.11 TCGA.44.6144.11 TCGA.44.6145.11
## GALM      15.55599000      18.3477000      13.4976300      12.4355000
## HK3        9.65274100      12.4103200      12.3639500      17.5058100
## G6PC       0.06917292       0.1689286       0.1555786       0.1847281
## PGM1      24.33696000      69.3011200      68.6039000      48.9442400
## HKDC1      0.65847880       1.2588160       3.0050750       2.8253770
## GPI       73.56174000      58.7149700      62.7976900      58.1940700
##       TCGA.44.6146.11 TCGA.44.6147.11
## GALM       16.5563600       8.3897860
## HK3         6.8267430       8.2327620
## G6PC        0.1555417       0.1721295
## PGM1       32.4310600      43.4132300
## HKDC1       1.1371050       0.5703535
## GPI        53.6260600      41.9420700</code></pre>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="co">#obtain the labels of the samples of the expression profile, the label vector is a vector of 0/1s,</span></span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a><span class="co"># 0 represents the case sample and 1 represents the control sample</span></span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a>label1<span class="ot">&lt;-</span><span class="fu">GetExampleData</span>(<span class="st">&quot;label1&quot;</span>)</span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a><span class="co">#view first ten label</span></span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a>label1[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>]</span></code></pre></div>
<pre><code>##  [1] 0 0 0 0 0 0 0 0 0 0</code></pre>
<p>we used the Student’s t-test to calculate the p-value for expression
level and methylation level of each gene in the tumor and normal
samples.label,0 represents normal samples;1 represents cancer
samples.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="co">#calculate p-values or corrected p-values for each gene</span></span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a></span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a>exp.p<span class="ot">&lt;-</span><span class="fu">getExpp</span>(exp_data,<span class="at">label =</span> label1,<span class="at">p.adjust =</span> <span class="cn">FALSE</span>)</span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a>label2<span class="ot">&lt;-</span><span class="fu">GetExampleData</span>(<span class="st">&quot;label2&quot;</span>)</span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a>meth_data<span class="ot">&lt;-</span><span class="fu">GetExampleData</span>(<span class="st">&quot;meth_data&quot;</span>)</span>
<span id="cb5-6"><a href="#cb5-6" tabindex="-1"></a>meth.p<span class="ot">&lt;-</span><span class="fu">getMethp</span>(meth_data,<span class="at">label =</span> label2,<span class="at">p.adjust =</span> <span class="cn">FALSE</span>)</span>
<span id="cb5-7"><a href="#cb5-7" tabindex="-1"></a>exp.p[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>,]</span></code></pre></div>
<pre><code>##            gene                    p
## GALM       GALM  0.00382104698965552
## HK3         HK3 1.22893635962516e-14
## G6PC       G6PC    0.309765961639907
## PGM1       PGM1 6.50659302913753e-05
## HKDC1     HKDC1 1.27479647059785e-05
## GPI         GPI 1.37454189773835e-11
## FBP1       FBP1 2.09855354282047e-12
## ALDOA     ALDOA 2.54043616919423e-14
## G6PC3     G6PC3 0.000265142879987233
## ALDH7A1 ALDH7A1  0.00626937915913354</code></pre>
<p>For copy number data, we can calculate p-value through the following
way:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="co">#obtain Copy number variation data</span></span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a>cnv_data<span class="ot">&lt;-</span><span class="fu">GetExampleData</span>(<span class="st">&quot;cnv_data&quot;</span>)</span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a><span class="co">#obtion amplified genes</span></span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a>amp_gene<span class="ot">&lt;-</span><span class="fu">GetExampleData</span>(<span class="st">&quot;amp_gene&quot;</span>)</span>
<span id="cb7-5"><a href="#cb7-5" tabindex="-1"></a><span class="co">#obtion deleted genes</span></span>
<span id="cb7-6"><a href="#cb7-6" tabindex="-1"></a>del_gene<span class="ot">&lt;-</span><span class="fu">GetExampleData</span>((<span class="st">&quot;del_gene&quot;</span>))</span></code></pre></div>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a><span class="co">#calculate p-values or corrected p-values for each gene</span></span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a>cnv.p<span class="ot">&lt;-</span><span class="fu">getCnvp</span>(exp_data,cnv_data,amp_gene,del_gene,<span class="at">p.adjust=</span><span class="cn">FALSE</span>,<span class="at">method=</span><span class="st">&quot;fdr&quot;</span>)</span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a>cnv.p[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>,]</span></code></pre></div>
<pre><code>##            gene                   p
## ACSS1     ACSS1 0.00641326042511501
## ACSS2     ACSS2                   1
## ADH1A     ADH1A   0.454656092798328
## ADH1B     ADH1B   0.429492188406724
## ADH5       ADH5 0.00253178462835118
## AKR1A1   AKR1A1                   1
## ALDH1A3 ALDH1A3                   1
## ALDH1B1 ALDH1B1                   1
## ALDH2     ALDH2   0.145658828705581
## ALDH3B1 ALDH3B1                   1</code></pre>
</div>
<div id="example-combine-p-values-of-different-kinds-of-data" class="section level2">
<h2>3 Example: Combine P-values of different kinds of data</h2>
<p>With the above data, we constructed an integrative gene z-score (Z)
based three datasets.</p>
<ul>
<li><p>Firstly,the gene score calculated through combined p-values of
Fisher’s Inverse chi-square tests. This method computes a combined
statistic S from the p-values of the difference coefficient obtained
from three individual datasets .Usually,the statistic S follows a
chi-square distribution with 2k degrees,we can calculate the null
hypothesis p-value of the statistic S.</p></li>
<li><p>Secondly,we convert the p-value to z-score according to Gaussian
distribution , which is taken as the gene z-score(Z) .</p></li>
</ul>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a><span class="co">#obtain the p-values of expression profile data,methylation profile data and Copy number variation data</span></span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a>exp.p<span class="ot">&lt;-</span><span class="fu">GetExampleData</span>(<span class="st">&quot;exp.p&quot;</span>)</span>
<span id="cb10-3"><a href="#cb10-3" tabindex="-1"></a>meth.p<span class="ot">&lt;-</span><span class="fu">GetExampleData</span>(<span class="st">&quot;meth.p&quot;</span>)</span>
<span id="cb10-4"><a href="#cb10-4" tabindex="-1"></a>cnv.p<span class="ot">&lt;-</span><span class="fu">GetExampleData</span>(<span class="st">&quot;cnv.p&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a><span class="co">#calculate z-scores for p-values of each kind of data</span></span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a>zexp<span class="ot">&lt;-</span><span class="fu">coverp2zscore</span>(exp.p)</span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a>zmeth<span class="ot">&lt;-</span><span class="fu">coverp2zscore</span>(meth.p)</span>
<span id="cb11-4"><a href="#cb11-4" tabindex="-1"></a>zcnv<span class="ot">&lt;-</span><span class="fu">coverp2zscore</span>(cnv.p)</span>
<span id="cb11-5"><a href="#cb11-5" tabindex="-1"></a><span class="co">#combine two kinds of p-values,then,calculate z-score for them</span></span>
<span id="cb11-6"><a href="#cb11-6" tabindex="-1"></a>zz<span class="ot">&lt;-</span><span class="fu">combinep_two</span>(exp.p,meth.p)</span>
<span id="cb11-7"><a href="#cb11-7" tabindex="-1"></a><span class="co">#combine three kinds of p-values,then,calculate z-score for them</span></span>
<span id="cb11-8"><a href="#cb11-8" tabindex="-1"></a>zzz<span class="ot">&lt;-</span><span class="fu">combinep_three</span>(exp.p,meth.p,cnv.p)</span>
<span id="cb11-9"><a href="#cb11-9" tabindex="-1"></a>zzz[<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>,]</span></code></pre></div>
<pre><code>##                       padjust          z_score                exp.p
## AACS     1.49856652283489e-12 6.97785849233781 4.27591802855694e-05
## AASDHPPT 3.59090577618182e-09 5.78661689489162 1.51758714809107e-05
## ACAA1    2.26766115435344e-06 4.58520914055579  0.00254706069215554
## ACACA    7.81825182198367e-05 3.78073660442176   0.0414461349050663
## ACACB    3.17474389450551e-24 10.0863369031681  1.0796730435591e-25
## ACAD8    8.80185318920442e-08 5.22301085773967 2.21022111058924e-05
##                        meth.p                cnv.p
## AACS     3.79351155555026e-07 0.000154005933715148
## AASDHPPT    0.138052336368975 4.95190895519194e-06
## ACAA1    4.80814465758352e-06                    1
## ACACA    1.62339209249856e-05                    1
## ACACB       0.152770581756488   0.0979253199784077
## ACAD8        0.19898879195769 7.67894501521561e-05</code></pre>
</div>
<div id="example-obtain-subpathways" class="section level2">
<h2>4 Example: Obtain subpathways</h2>
<p>For a priori KEGG path, we perform a greedy algorithm to search for
interested subpathways.We provide two statistical test methods of the
subpathway, which one is whole gene-based perturbation, and the other is
the local gene perturbation in a particular pathway.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a><span class="co">#obtain z-score of each gene</span></span>
<span id="cb13-2"><a href="#cb13-2" tabindex="-1"></a>zzz<span class="ot">&lt;-</span><span class="fu">GetExampleData</span>(<span class="st">&quot;zzz&quot;</span>)</span>
<span id="cb13-3"><a href="#cb13-3" tabindex="-1"></a>zzz[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>,]</span></code></pre></div>
<pre><code>##                       padjust          z_score                exp.p
## AACS      1.4985665228349e-12 6.97785849233781 4.27591802855694e-05
## AASDHPPT 3.59090577618182e-09 5.78661689489162 1.51758714809107e-05
## ACAA1    2.26766115435345e-06 4.58520914055579  0.00254706069215554
## ACACA    7.81825182198368e-05 3.78073660442176   0.0414461349050663
## ACACB    3.17474389450549e-24 10.0863369031681  1.0796730435591e-25
## ACAD8    8.80185318920443e-08 5.22301085773967 2.21022111058924e-05
## ACADL    6.14820533862155e-54 15.4184802326598 2.63073053599382e-55
## ACAT1     1.1545332900424e-06 4.72430235586153 6.58517201812735e-06
## ACER1    2.96364608769913e-06  4.5289664035691                    1
## ACER3    1.63555761386473e-07 5.10711682637474  5.9116689567922e-07
##                        meth.p                cnv.p
## AACS     3.79351155555026e-07 0.000154005933715148
## AASDHPPT    0.138052336368975 4.95190895519194e-06
## ACAA1    4.80814465758352e-06                    1
## ACACA    1.62339209249856e-05                    1
## ACACB       0.152770581756488   0.0979253199784077
## ACAD8        0.19898879195769 7.67894501521561e-05
## ACADL     0.00265801159320894                    1
## ACAT1       0.287245454170909  0.00305344462196611
## ACER1    1.65137200042873e-08                    1
## ACER3     0.00112767915011995                    1</code></pre>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a><span class="fu">require</span>(graphite)</span>
<span id="cb15-2"><a href="#cb15-2" tabindex="-1"></a>zz<span class="ot">&lt;-</span><span class="fu">GetExampleData</span>(<span class="st">&quot;zzz&quot;</span>)</span>
<span id="cb15-3"><a href="#cb15-3" tabindex="-1"></a><span class="co">#subpathdata&lt;-FindSubPath(zz) #only show</span></span></code></pre></div>
<p>Optimize interested subpathways.If the number of genes shared by the
two pathways accounted for more than the Overlap ratio of each pathway
genes,than combine two pathways.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" tabindex="-1"></a>subpathdata<span class="ot">&lt;-</span><span class="fu">GetExampleData</span>(<span class="st">&quot;subpathdata&quot;</span>)</span>
<span id="cb16-2"><a href="#cb16-2" tabindex="-1"></a>keysubpathways<span class="ot">&lt;-</span><span class="fu">opt_subpath</span>(subpathdata,zz,<span class="at">overlap=</span><span class="fl">0.6</span>)</span>
<span id="cb16-3"><a href="#cb16-3" tabindex="-1"></a><span class="fu">head</span>(keysubpathways)</span></code></pre></div>
<pre><code>##      SubpathwayID  pathway                       
## [1,] &quot;path00010_1&quot; &quot;Glycolysis / Gluconeogenesis&quot;
## [2,] &quot;path00010_2&quot; &quot;Glycolysis / Gluconeogenesis&quot;
## [3,] &quot;path00010_3&quot; &quot;Glycolysis / Gluconeogenesis&quot;
## [4,] &quot;path00010_4&quot; &quot;Glycolysis / Gluconeogenesis&quot;
## [5,] &quot;path00010_5&quot; &quot;Glycolysis / Gluconeogenesis&quot;
## [6,] &quot;path00010_6&quot; &quot;Glycolysis / Gluconeogenesis&quot;
##      Subgene                                                                
## [1,] &quot;G6PC/HK3/PGM1/HKDC1/GPI/FBP1/ALDOA/G6PC2/GALM/G6PC3&quot;                  
## [2,] &quot;ADH5/ADH1B/ADH1A/ALDH3B2/ALDH2/AKR1A1/ALDH7A1/ALDH3B1/ALDH1B1/ALDH1A3&quot;
## [3,] &quot;PKLR/ENO1/LDHA/PGAM1/MINPP1/PCK1/LDHAL6A/LDHAL6B&quot;                     
## [4,] &quot;ACSS1/ALDH3B2/ADH1B/ADH1A/ALDH2/DLAT/ACSS2&quot;                           
## [5,] &quot;PFKP/ALDOA/GAPDH/FBP1/GPI/ALDOC/GAPDHS&quot;                               
## [6,] &quot;PGAM4/ENO1/PGAM1/MINPP1/PCK1/PGK2&quot;                                    
##      Size SubpathwayZScore  
## [1,] &quot;10&quot; &quot;20.8492758044976&quot;
## [2,] &quot;10&quot; &quot;20.9317587858665&quot;
## [3,] &quot;8&quot;  &quot;19.0899605586423&quot;
## [4,] &quot;7&quot;  &quot;19.7078248333379&quot;
## [5,] &quot;7&quot;  &quot;18.3020024323356&quot;
## [6,] &quot;6&quot;  &quot;16.7772761794305&quot;</code></pre>
<p>the perturbation test was used to calculate statistical significance
for these interested subpathways.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" tabindex="-1"></a>keysubpathways<span class="ot">&lt;-</span><span class="fu">Permutation</span>(keysubpathways,zz,<span class="at">nperm1=</span><span class="dv">100</span>,<span class="at">method1=</span><span class="cn">TRUE</span>,<span class="at">nperm2=</span><span class="dv">100</span>,<span class="at">method2=</span><span class="cn">FALSE</span>)</span>
<span id="cb18-2"><a href="#cb18-2" tabindex="-1"></a><span class="fu">head</span>(keysubpathways)</span></code></pre></div>
<pre><code>##      SubpathwayID  pathway                       
## [1,] &quot;path00010_1&quot; &quot;Glycolysis / Gluconeogenesis&quot;
## [2,] &quot;path00010_2&quot; &quot;Glycolysis / Gluconeogenesis&quot;
## [3,] &quot;path00010_3&quot; &quot;Glycolysis / Gluconeogenesis&quot;
## [4,] &quot;path00010_4&quot; &quot;Glycolysis / Gluconeogenesis&quot;
## [5,] &quot;path00010_5&quot; &quot;Glycolysis / Gluconeogenesis&quot;
## [6,] &quot;path00010_6&quot; &quot;Glycolysis / Gluconeogenesis&quot;
##      Subgene                                                                
## [1,] &quot;G6PC/HK3/PGM1/HKDC1/GPI/FBP1/ALDOA/G6PC2/GALM/G6PC3&quot;                  
## [2,] &quot;ADH5/ADH1B/ADH1A/ALDH3B2/ALDH2/AKR1A1/ALDH7A1/ALDH3B1/ALDH1B1/ALDH1A3&quot;
## [3,] &quot;PKLR/ENO1/LDHA/PGAM1/MINPP1/PCK1/LDHAL6A/LDHAL6B&quot;                     
## [4,] &quot;ACSS1/ALDH3B2/ADH1B/ADH1A/ALDH2/DLAT/ACSS2&quot;                           
## [5,] &quot;PFKP/ALDOA/GAPDH/FBP1/GPI/ALDOC/GAPDHS&quot;                               
## [6,] &quot;PGAM4/ENO1/PGAM1/MINPP1/PCK1/PGK2&quot;                                    
##      Size SubpathwayZScore   p1     fdr1               
## [1,] &quot;10&quot; &quot;20.8492758044976&quot; &quot;0.08&quot; &quot;0.476279069767442&quot;
## [2,] &quot;10&quot; &quot;20.9317587858665&quot; &quot;0.1&quot;  &quot;0.501960784313725&quot;
## [3,] &quot;8&quot;  &quot;19.0899605586423&quot; &quot;0.08&quot; &quot;0.476279069767442&quot;
## [4,] &quot;7&quot;  &quot;19.7078248333379&quot; &quot;0.03&quot; &quot;0.333913043478261&quot;
## [5,] &quot;7&quot;  &quot;18.3020024323356&quot; &quot;0.07&quot; &quot;0.471578947368421&quot;
## [6,] &quot;6&quot;  &quot;16.7772761794305&quot; &quot;0.08&quot; &quot;0.476279069767442&quot;</code></pre>
</div>
<div id="example-plot-a-network-graph-when-user-input-a-list-of-gene" class="section level2">
<h2>4 Example: plot a network graph when user input a list of gene</h2>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" tabindex="-1"></a><span class="fu">require</span>(graphite)</span>
<span id="cb20-2"><a href="#cb20-2" tabindex="-1"></a><span class="fu">require</span>(org.Hs.eg.db)</span>
<span id="cb20-3"><a href="#cb20-3" tabindex="-1"></a>subpID<span class="ot">&lt;-</span><span class="fu">unlist</span>(<span class="fu">strsplit</span>(<span class="st">&quot;ACSS1/ALDH3B2/ADH1B/ADH1A/ALDH2/DLAT/ACSS2&quot;</span>,<span class="st">&quot;/&quot;</span>))</span>
<span id="cb20-4"><a href="#cb20-4" tabindex="-1"></a>pathway.name<span class="ot">=</span><span class="st">&quot;Glycolysis / Gluconeogenesis&quot;</span></span>
<span id="cb20-5"><a href="#cb20-5" tabindex="-1"></a>zzz<span class="ot">&lt;-</span> <span class="fu">GetExampleData</span>(<span class="st">&quot;zzz&quot;</span>)</span>
<span id="cb20-6"><a href="#cb20-6" tabindex="-1"></a><span class="fu">PlotSubpathway</span>(<span class="at">subpID=</span>subpID,<span class="at">pathway.name=</span>pathway.name,<span class="at">zz=</span>zzz)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
